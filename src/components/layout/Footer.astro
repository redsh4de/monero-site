---
import externalLinkDark from "../../assets/external-link-dark.png?url";
import externalLinkLight from "../../assets/external-link-light.png?url";
interface Link {
    label: string;
    href: string;
}

interface Column {
    title: string;
    links: Link[];
}

const isExternal = (href: string) =>
    !href.startsWith("#") &&
    !href.startsWith("/") &&
    !href.includes("getmonero.org");

const columns: Column[] = [
    {
        title: "Resources",
        links: [
            { label: "Knowledge Base", href: "/resources/knowledge-base" },
            { label: "Developer guides", href: "/resources/developer-guides" },
            { label: "User guides", href: "/resources/user-guides" },
            { label: "Downloads", href: "/downloads" },
        ],
    },
    {
        title: "Reach out",
        links: [
            { label: "Workgroups", href: "/community/workgroups" },
            { label: "Hangouts", href: "/community/hangouts" },
            {
                label: "Mailing list",
                href: "/postorius/lists/monero-announce.lists.getmonero.org",
            },
        ],
    },
    {
        title: "Community",
        links: [
            { label: "Merchants & Exchanges", href: "/community/merchants" },
            {
                label: "Stack Exchange",
                href: "https://monero.stackexchange.com/",
            },
            {
                label: "Bitcoin Talk",
                href: "https://bitcointalk.org/index.php?topic=583449.0",
            },
            { label: "Weblate", href: "https://translate.getmonero.org" },
        ],
    },
    {
        title: "The Monero Project",
        links: [
            { label: "Open Alias", href: "https://openalias.org" },
            {
                label: "Monero Research Lab (MRL)",
                href: "/resources/research-lab",
            },
            { label: "Press Kit", href: "/resources/press-kit" },
            {
                label: "Community Crowdfunding System",
                href: "https://ccs.getmonero.org",
            },
        ],
    },
];

const bottomLinks: Link[] = [
    { label: "Tor Onion service", href: "#" },
    { label: "Vulnerability response", href: "https://github.com/monero-project/meta/blob/master/VULNERABILITY_RESPONSE_PROCESS.md" },
    { label: "Legal", href: "/legal" },
    { label: "Source code", href: "https://github.com/monero-project/monero-site" },
    { label: "Sitemap", href: "/sitemap-index.xml" },
    { label: "RSS Feed", href: "/feed.xml" },
];
---

<footer class="footer" aria-labelledby="footer-heading">
    <div class="items">
        <nav class="grid" aria-label="Footer navigation">
            {
                columns.map((col) => (
                    <section class="col">
                        <h3 class="title">{col.title}</h3>
                        <ul class="list">
                            {col.links.map((l) => (
                                <li>
                                    <a
                                        href={l.href}
                                        target={
                                            isExternal(l.href)
                                                ? "_blank"
                                                : undefined
                                        }
                                        rel={
                                            isExternal(l.href)
                                                ? "noopener noreferrer"
                                                : undefined
                                        }
                                    >
                                        {l.label}
                                        {isExternal(l.href) ? (
                                            <div 
                                                class="external-icon" 
                                                style={`--icon-light: url(${externalLinkLight}); --icon-dark: url(${externalLinkDark});`}
                                            ></div>
                                        ) : (
                                            ""
                                        )}
                                    </a>
                                </li>
                            ))}
                        </ul>
                    </section>
                ))
            }
        </nav>

        <nav class="bottom" aria-label="Secondary footer navigation">
            <ul class="inline-list">
                {
                    bottomLinks.map((l) => (
                        <li class="inline-item">
                            <a
                                href={l.href}
                                target={
                                    isExternal(l.href) ? "_blank" : undefined
                                }
                                rel={
                                    isExternal(l.href)
                                        ? "noopener noreferrer"
                                        : undefined
                                }
                            >
                                {l.label}
                                {isExternal(l.href) ? (
                                    <div 
                                        class="external-icon" 
                                        style={`--icon-light: url(${externalLinkLight}); --icon-dark: url(${externalLinkDark});`}
                                    ></div>
                                ) : (
                                    ""
                                )}
                            </a>
                        </li>
                    ))
                }
            </ul>
        </nav>
    </div>
</footer>

<style>
    .footer {
        background: var(--card-color);
        font-size: 0.95rem;
    }

    .items {
        padding: 1em 5em;
        padding-top: 5em;
        padding-bottom: 5em;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 2rem;
    }

    .title {
        margin: 0 0 2rem;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--heading-color);
    }

    .list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .list li {
        margin: 8px 0;
    }

    a {
        color: var(--heading-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 4px;
    }

    a:hover,
    a:focus {
        color: var(--paragraph-subtitle);
        outline: none;
    }

    .bottom {
        margin-top: 5em;
        font-size: 0.9rem;
        color: var(--paragraph-subtitle);
    }

    .inline-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-wrap: wrap;
        gap: 18px 28px;
        justify-content: center;
    }

    .inline-item a {
        color: var(--footer-muted);
    }

    .inline-item a:hover,
    .inline-item a:focus {
        color: var(--heading-color);
    }

    .external-icon {
        width: 12px;
        height: 12px;
        background-image: var(--icon-light);
        background-size: contain;
        background-repeat: no-repeat;
        flex-shrink: 0;
    }
    @media (prefers-color-scheme: dark) {
        .external-icon {
            background-image: var(--icon-dark);
        }
    }

    /* Responsive */
    @media (max-width: 980px) {
        .items {
            padding: 1em 2em;
            padding-top: 4em;
        }
        .grid {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }
    }
    @media (max-width: 560px) {
        .grid {
            grid-template-columns: 1fr;
        }
        .wrap {
            padding: 40px 16px 22px;
        }
    }
</style>
