---
import Layout from "../layouts/Layout.astro";
import { defaultLocale } from "../config/i18n";
import { generatePaths } from "../lib/path-utils";

// One eager glob used at runtime to render
const views = import.meta.glob("/src/views/**/[!_]*.astro", { eager: true });

export async function getStaticPaths() {
  return generatePaths([defaultLocale]);
}

// ---------- Runtime render ----------
type Props = { viewKey: string; };

const { viewKey } = Astro.props as Props;

const mod = views[viewKey] as any;
const View = mod?.default;
if (!View) {
  return Astro.redirect("/404");
}
---

<Layout>
  <View/>
</Layout>
