---
import Layout from "@/layouts/Layout.astro";
import TitleCard from "@/components/ui/TitleCard.astro";

import bankIcon from "@/assets/icons/mask/bank.avif";
import bitcoinIcon from "@/assets/icons/mask/bitcoin.avif";
import externalLinkIcon from "@/assets/icons/mask/external-link.avif";
import hashtagIcon from "@/assets/icons/mask/hashtag.avif";
import hatGlassesIcon from "@/assets/icons/mask/hat-glasses.avif";
import shieldIcon from "@/assets/icons/mask/shieldAlert.avif";
import rabbitIcon from "@/assets/icons/mask/rabbit.avif";
import MaskIcon from "@/components/ui/MaskIcon.astro";

import DisclaimerBar from "@/components/ui/DisclaimerBar.astro";
import ExchangeTable from "@/components/pages/get-started/exchanges/ExchangeTable.astro";

const highlightOptions = [
  {
    id: "highlight-bitcoin",
    linkClass: "crypto-option",
    icon: bitcoinIcon,
    title: "I have Bitcoin or other crypto",
  },
  {
    id: "highlight-fiat",
    linkClass: "fiat-option",
    icon: bankIcon,
    title: "I have cash or bank account",
  },
  {
    id: "highlight-privacy",
    linkClass: "privacy-option",
    icon: hatGlassesIcon,
    title: "I want privacy",
  },
  {
    id: "highlight-easiest",
    linkClass: "easiest-option",
    icon: rabbitIcon,
    title: "I want the simplest way",
  },
];

const decentralizedExchanges = [
  {
    type: "decentralized",
    name: "BasicSwapDEX",
    img: "/media/basicswapdex.jpg",
    alt: "BasicSwapDEX logo",
    description:
      "Atomic swap DEX for trustless and decentralized cryptocurrency exchanges.",
    fiat: false,
    crypto: true,
    url: "https://basicswapdex.com",
  },
  {
    type: "decentralized",
    name: "Bisq",
    img: "/media/bisq.png",
    alt: "Bisq logo",
    description:
      "Decentralized exchange for peer-to-peer cryptocurrency trading. Supports BTC -> XMR trades.",
    fiat: true,
    crypto: true,
    url: "https://bisq.network",
  },
  {
    type: "decentralized",
    name: "Eigenwallet",
    img: "/media/eigenwallet.avif",
    alt: "Eigenwallet logo",
    description:
      "Monero wallet with integrated BTC -> XMR atomic swaps",
    fiat: false,
    crypto: true,
    url: "https://eigenwallet.com",
  },
  {
    type: "decentralized",
    name: "RetoSwap",
    img: "/media/retoswap.jpg",
    alt: "RetoSwap logo",
    description:
      "Decentralized exchange built on Monero. Note that some services may require banking details for fiat integration.",
    fiat: true,
    crypto: true,
    url: "https://retoswap.com",
  },
];

const swapAggregators = [
  {
    type: "aggregator",
    name: "CypherGoat",
    img: "/media/cyphergoat.png",
    alt: "CypherGoat logo",
    description: "Decentralized aggregator for secure cryptocurrency exchanges.",
    fiat: false,
    crypto: true,
    url: "https://cyphergoat.com",
  },
  {
    type: "aggregator",
    name: "OrangeFren",
    img: "/media/orangefren.jpg",
    alt: "OrangeFren logo",
    description:
      "User-friendly aggregator for quick and easy crypto swaps without registration.",
    fiat: true,
    crypto: true,
    url: "https://orangefren.com",
  },
  {
    type: "aggregator",
    name: "Trocador",
    img: "/media/trocador-logo.webp",
    alt: "Trocador logo",
    description: "Privacy-focused swap aggregator.",
    fiat: false,
    crypto: true,
    url: "https://trocador.app",
  },
];

const centralizedExchanges = [
  {
    type: "centralized",
    name: "Bitfinex",
    img: "/media/bitfinex.png",
    alt: "Bitfinex logo",
    description:
      "Professional trading platform offering a wide range of cryptocurrencies and derivatives.",
    kycClass: "kyc-required",
    kycLabel: "Required",
    fiat: true,
    crypto: true,
    url: "https://bitfinex.com",
  },
  {
    type: "centralized",
    name: "Kraken",
    img: "/media/kraken.png",
    alt: "Kraken logo",
    description:
      "US-based cryptocurrency exchange with advanced trading features and fiat support.",
    kycClass: "kyc-required",
    kycLabel: "Required",
    fiat: true,
    crypto: true,
    url: "https://kraken.com",
  },
  {
    type: "centralized",
    name: "KuCoin",
    img: "/media/kucoin.png",
    alt: "KuCoin logo",
    description:
      "Popular exchange known for its extensive selection of altcoins.",
    kycClass: "kyc-required",
    kycLabel: "Required",
    fiat: true,
    crypto: true,
    url: "https://kucoin.com",
  },
];
---

<Layout
  title="Exchanges"
  description="Cryptocurrency exchanges that let you buy or trade Monero."
>
  <TitleCard
    title="Exchanges"
    subtitle="Cryptocurrency exchanges that let you buy or trade Monero."
  />

  <DisclaimerBar icon={shieldIcon} title="Disclaimer">
    This list is for informational purposes only. The Monero
    Project does not endorse, recommend, or guarantee any service listed here.
    Verify URLs carefully and use services at your own risk.
  </DisclaimerBar>

  <!-- highlight anchors -->
  <div id="highlight-bitcoin" class="highlight-target"></div>
  <div id="highlight-fiat" class="highlight-target"></div>
  <div id="highlight-privacy" class="highlight-target"></div>
  <div id="highlight-easiest" class="highlight-target"></div>
  <div id="clear" class="highlight-target"></div>

  <div class="exchanges-page-layout">
    <aside class="sidebar">
      <div class="intro-section card">
        <h2 class="intro-title">New to Monero?</h2>
        <p class="intro-description">Find the best option for you.</p>
        <div class="highlight-options">
          {highlightOptions.map((opt) => (
            <a href={`#${opt.id}`} class={`highlight-option ${opt.linkClass}`}>
              <span class="highlight-option-icon">
                <MaskIcon src={opt.icon} size="1.5em" aria-hidden="true" />
              </span>
              <div class="content">
                <span class="highlight-option-title">{opt.title}</span>
              </div>
              <div class="highlight-option-arrow">
                <MaskIcon src={hashtagIcon} size="0.75em" aria-hidden="true" />
              </div>
            </a>
          ))}
          <div class="clear-highlights">
            <a href="#clear" class="clear-highlights-link">Clear selection</a>
          </div>
        </div>
      </div>
    </aside>

    <main class="main-content">
      <ExchangeTable
        title="Decentralized Exchanges & Atomic Swaps"
        description="Decentralized exchanges and atomic swaps enable peer-to-peer trading of Monero, enhancing privacy and security."
        exchanges={decentralizedExchanges}
        hasKyc={false}
      />

      <ExchangeTable
        title="Swap Aggregators"
        description="Swap aggregators compare rates from multiple platforms to help you find the best deals for trading Monero."
        exchanges={swapAggregators}
        hasKyc={false}
        disclaimerText="Note that while aggregators don't hold your funds, the underlying swap service might require KYC verification."
      >
        <p class="paragraph-secondary extra-margin-top">
          For an up-to-date list with details and reviews, visit the community resource below.
        </p>
        <a
          href="https://kycnot.me/?categories=aggregator&currency-mode=or&currencies=xmr"
          target="_blank"
          rel="noopener noreferrer"
          class="kycnot-button aggregator-highlight crypto-highlight"
        >
          <img
            src="/media/kycnotme.jpg"
            alt="KYCNot.me logo"
            class="kycnot-logo"
          />
          <span class="kycnot-title">KYCNot.me</span>
          <MaskIcon src={externalLinkIcon} size="1em" />
        </a>
      </ExchangeTable>

      <ExchangeTable
        title="Centralized Exchanges"
        description="Centralized exchanges are traditional platforms where you can buy and sell Monero, often requiring KYC verification."
        exchanges={centralizedExchanges}
        hasKyc={true}
      />
    </main>
  </div>
</Layout>

<style>
  .exchanges-page-layout {
    display: flex;
    gap: 2rem;
    margin: 2rem 0;
  }

  .card {
    background: var(--card-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
  }

  .sidebar {
    flex: 0 0 400px;
  }

  .main-content {
    flex: 1;
  }

  .intro-section {
    padding: 2rem;
  }

  .intro-title {
    margin-top: 0;
    color: var(--heading-color);
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    margin-bottom: 1rem;
  }

  .intro-description {
    color: var(--text-primary);
    font-size: var(--font-size-lg);
    margin-bottom: 2rem;
  }

  .highlight-options {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .highlight-option {
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    gap: 1rem;
    padding: 0.75rem;
    background: var(--card-hover-color);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    text-decoration: none;
  }

  .highlight-option:hover {
    background: color-mix(in srgb, var(--card-color), white 10%);
    cursor: pointer;
  }

  .highlight-option-icon {
    color: var(--monero-orange);
  }

  .highlight-option-arrow {
    display: flex;
    align-items: flex-start;
    margin-inline-start: auto;
    color: var(--paragraph-subtitle);
  }

  .highlight-option-title {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--heading-color);
    display: block;
  }

  .clear-highlights {
    text-align: right;
  }

  .clear-highlights-link {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: var(--font-size-sm);
  }

  .clear-highlights-link:hover {
    text-decoration: underline;
  }

  .highlight-target {
    display: none;
  }

  /* Row highlighting based on properties */
  #highlight-bitcoin:target
    ~ :global(.exchanges-page-layout
    .crypto-highlight) {
    background: rgba(255, 152, 0, 0.1);
  }

  #highlight-fiat:target
    ~ :global(.exchanges-page-layout
    .fiat-highlight) {
    background: rgba(255, 152, 0, 0.1);
  }

  #highlight-privacy:target
    ~ :global(.exchanges-page-layout
    .privacy-highlight) {
    background: rgba(255, 152, 0, 0.1);
  }

  #highlight-easiest:target
    ~ :global(.exchanges-page-layout
    .aggregator-highlight) {
    background: rgba(255, 152, 0, 0.1);
  }

  /* Sidebar option highlighting */
  #highlight-bitcoin:target
    ~ .exchanges-page-layout
    .sidebar
    .crypto-option,
  #highlight-fiat:target
    ~ .exchanges-page-layout
    .sidebar
    .fiat-option,
  #highlight-privacy:target
    ~ .exchanges-page-layout
    .sidebar
    .privacy-option,
  #highlight-easiest:target
    ~ .exchanges-page-layout
    .sidebar
    .easiest-option {
    background: color-mix(in srgb, var(--card-color), white 10%);
    border-color: var(--monero-orange);
  }

  .extra-margin-top {
    margin-top: 1rem;
  }

  .kycnot-button {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--card-color);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    text-decoration: none;
    color: inherit;
    margin-top: 1rem;
  }

  .kycnot-button:hover {
    background: color-mix(in srgb, var(--card-color), white 10%);
  }

  .kycnot-logo {
    width: 48px;
    height: 48px;
    border-radius: 0.5rem;
  }

  .kycnot-title {
    font-weight: var(--font-weight-semibold);
    color: var(--heading-color);
  }

  @media (max-width: 1200px) {
    .exchanges-page-layout {
      flex-direction: column;
    }

    .sidebar {
      flex: none;
    }
  }
</style>